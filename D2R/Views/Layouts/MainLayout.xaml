<UserControl x:Class="D2R.Views.MainLayout"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:conv="clr-namespace:D2R.Converters"
             mc:Ignorable="d"
             x:Name="MainShell" >
    <UserControl.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </UserControl.Resources>


    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <!-- Thanh header chứa nút chuông -->
            <RowDefinition Height="*"/>
            <!-- Nội dung sidebar + main content -->
        </Grid.RowDefinitions>

        <!-- Header (chứa chuông) -->
        <Grid Background="#F0F0F0" Grid.Row="0">
            <Button x:Name="NotificationButton"
                Width="66" Height="40"
                Content="🔔"
                FontSize="24"
                Click="NotificationButton_Click"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Margin="115,0,0,0"/>

            <!-- Popup xổ thông báo -->
            <Popup x:Name="NotificationPopup"
               PlacementTarget="{Binding ElementName=NotificationButton}"
               Placement="Bottom"
               StaysOpen="False">
                <Border Background="White" BorderBrush="Gray" BorderThickness="1" Width="300" Height="400">
                    <ListBox x:Name="NotificationList" SelectionChanged="NotificationList_SelectionChanged">
                        <!-- Mỗi item thông báo sẽ load vào đây -->
                    </ListBox>
                </Border>
            </Popup>
        </Grid>

        <!-- Nội dung chính: chia làm Sidebar và MainContent -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" x:Name="SidebarColumn"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Sidebar -->
            <Grid x:Name="SidebarPanel"
              Grid.Column="0"
              Panel.ZIndex="1"
              Background="#F0A5A5"
              HorizontalAlignment="Left">
                <StackPanel HorizontalAlignment="Left" VerticalAlignment="Stretch">
                    <!-- Toggle Button giữ nguyên -->
                    <ToggleButton x:Name="SidebarToggleButton"
                  Style="{StaticResource MaterialDesignHamburgerToggleButton}"
                  IsChecked="True"
                  Checked="SidebarToggleButton_Checked"
                  Unchecked="SidebarToggleButton_Unchecked"
                  Margin="10"
                  HorizontalAlignment="Right">
                        <materialDesign:PackIcon Kind="Menu" Width="28" Height="28" />
                    </ToggleButton>

                    <!-- Menu Buttons giãn cách đều -->
                    <UniformGrid Rows="9" VerticalAlignment="Stretch" >
                        <!-- Trang chủ -->
                        <Button
                            Margin="0,5"
            Style="{StaticResource MaterialDesignRaisedButton}"
            ToolTip="Trang chủ"
            Click="Home_Click"
            HorizontalContentAlignment="Left"
            Padding="10,5"
            materialDesign:ButtonAssist.CornerRadius="10"
            IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
            Background="#EB7F7F"
            BorderBrush="#E9D7D7"
            Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Home" Foreground="CornflowerBlue" Width="28" Height="28" />
                                <TextBlock Text="Trang chủ"
                           Margin="10,0,0,0"
                           FontSize="16"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>

                        <!-- Quản lý tài khoản -->
                        <Button 
                            Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Quản lý tài khoản" Click="ManageAccounts_Click"
                HorizontalContentAlignment="Left" Padding="10,5"
                materialDesign:ButtonAssist.CornerRadius="10"
                Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="AccountMultiple" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Quản lý tài khoản"
                           Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>

                        <!-- Quản lý MTQ -->
                        <Button Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Quản lý Mạnh Thường Quân" Click="ManageDonors_Click"
                HorizontalContentAlignment="Left" Padding="10,5"
                materialDesign:ButtonAssist.CornerRadius="10"
                Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="AccountHeartOutline" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Quản lý MTQ"
                           Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>

                        <!-- Quản lý kho -->
                        <Button Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Quản lý kho" Click="ManageWarehouse_Click"
                HorizontalContentAlignment="Left" Padding="10,5"
                materialDesign:ButtonAssist.CornerRadius="10"
                Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Warehouse" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Quản lý kho"
                           Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>

                        <!-- Yêu cầu cứu trợ -->
                        <Button Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Yêu cầu cứu trợ" Click="RequestSupport_Click"
                HorizontalContentAlignment="Left" Padding="10,5"
                materialDesign:ButtonAssist.CornerRadius="10"
                Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="HandshakeOutline" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Yêu cầu cứu trợ"
                           Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>

                        <!-- Thống kê -->
                        <Button Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Thống kê" Click="Statistics_Click"
                HorizontalContentAlignment="Left" Padding="10,5"
                materialDesign:ButtonAssist.CornerRadius="10"
                Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="ChartBar" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Thống kê"
                           Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>

                        <!-- Đăng xuất -->
                        <Button Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Đăng xuất" Click="Logout_Click"
                HorizontalContentAlignment="Left" Padding="10,5"
                materialDesign:ButtonAssist.CornerRadius="10"
                Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="LogoutVariant" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Đăng xuất"
                           Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>

                        <Button 
              Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Phân phối" Click="DistributionAdmin_Click"
  HorizontalContentAlignment="Left" Padding="10,5"
  materialDesign:ButtonAssist.CornerRadius="10"
  Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="AccountMultiple" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Phân phối"
             Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
             VerticalAlignment="Center"
             Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>


                        <Button 
                  Style="{StaticResource MaterialDesignRaisedButton}" ToolTip="Kiểm tra" Click="CheckAdmin_Click"
                          HorizontalContentAlignment="Left" Padding="10,5"
                          materialDesign:ButtonAssist.CornerRadius="10"
                          Background="#EB7F7F" BorderBrush="#E9D7D7" Foreground="White">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="AccountMultiple" Foreground="Black" Width="28" Height="28" />
                                <TextBlock Text="Kiểm tra"
                                     Margin="10,0,0,0" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"
                                     VerticalAlignment="Center"
                                     Visibility="{Binding IsSidebarExpanded, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>
                        </Button>



                    </UniformGrid>
                </StackPanel>

            </Grid>

            <!-- Main Content -->
            <ContentControl x:Name="MainContent"
                        Grid.Column="1"
                        Background="White"
                        Margin="0"/>
        </Grid>
    </Grid>
</UserControl>
